# 吉甲大师电控组编码规范

**注：本编码规范要求吉甲大师电控组所有成员严格遵守，若审查到不符合规范的代码会被要求进行修改**

---

## 命名方式

* ### **基础要求**

(1) 缩写

较短单词可去除元音字母形成缩写，如`temp->tmp`、`flag->flg`等

较长单词可取前部分字母，如`result->res`、`increment->inc`、`initialize->init`等

或使用一些常见缩写，如`massage->msg`、`password->pwd/pswd`等

(2) 非特殊情况**不要使用汉语拼音**作为标识符，更不允许使用拼音首字母缩写

(3) 必要时查阅词典，避免拼写错误

* ### **变量**

(1) 给变量命名时应使用贴合变量意义的单词构成，不应使用`a`、`b`、`w`等简单变量名（在简单循环中可以使用`i`、`j`等常用循环变量）

(2) 变量命名方法有`驼峰命名法`和`下划线命名法`

`驼峰命名法`：使用大写字母分割名字中的各个单词，命名变量时**首字母为小写**

`下划线命名法`：使用下划线分割名字中的单词，应**全为小写**

> 注意：各兵种可采用不同命名法，但在**同一个代码工程中需统一使用同一种方法**

以下为一些命名示例
```c
//驼峰命名法示例
userName userPassword
//下划线命名法示例
user_name user_password
//不规范的变量命名
UserName user_Name USER_NAME username
```

* ### **函数**

函数命名方式推荐与使用的环境（即库函数）风格一致，得到以下规范

(1) 函数所在的**模块名**，以**首字母大写**的形式加下划线作为函数开头，如`Chassis_`、`System_`

(2) 函数名其余部分使用**首字母大写**的驼峰命名法

以下为一些命名示例
```c
//规范的命名
Chassis_RegisterEvents() System_Init()
//不规范的命名
registerEvents() chassis_register_events()
```
* ### **结构体&枚举**

(1) 命名方式应使用**首字母大写**的驼峰命名法，如`Chassis`、`Gimbal`、`TaskState`等

(2) 结构体和枚举命名应使用`typedef`关键词进行类型重命名，使得在使用时无需加`struct`和`enum`关键词

例如以下写法
```c
typedef struct
{
	int number;
	char *name;
	int score;
}Student;

typedef enum
{
	Red,
	Blue,
	Green
}Color;
```

* ### **宏定义**

宏定义命名使用**全部字母大写**，单词间分割使用下划线

以下为一些命名示例
```c
//规范的宏定义命名
TASK_MAX_NUM MAX_LOG_LENGTH ABS(x)
//不规范的宏定义命名
Task_Max_Num task_max_num Abs(x) abs(x)
```

---

## 对齐&缩进
(1) 程序块分界符（左右花括号`{}`）应分别独占一行并垂直对齐，且与引用它们的代码左对齐
```c
//规范的if
if(a==0)
{
	//code
}

//不规范的if
if(a==1)
	{
		//code
}

if(a==1){
	//code
}
```

(2) 花括号内部的代码块向右缩进一个<kbd>tab</kbd>或2/4个<kbd>space</kbd>（建议使用tab），**同一个代码工程中需统一缩进方式**

(3) 若`if`、`else if`、`else`、`while`、`for`内的语句只有一行，可以不使用花括号包裹，执行语句需要写在条件语句的下一行并向右缩进，其下方的其他语句不得与该执行语句左对齐

```c
//不规范的单行if
if(a==1) a=0;//不允许写在一行

if(a==1)
a=0;//没有向右缩进

if(a==1)
    a=0;
    b=1;//此语句在if外，若这么写可能引起误解

//规范的单行if
if(a==1)
    a=0;//向右缩进
else if(a==0)
    a=1;
b=1;//if外的语句应该与if垂直对齐

if(a==1)
{
    a=0;//也可以正常加括号包裹
}
```

(4) 空循环应在后面添加一对空的花括号（而不是一个分号）
```c
//不规范的空循环
while(a==1);

//规范的空循环
while(a==1){}
```

---

## 注释
(1) 每一条**宏定义**必须有注释

(2) 变量名若含有一些**不是明显约定俗成的缩写**，必须在其定义处注释中标明作用

(3) `switch`语句中，若由于一些特殊情况需要连续进入两个`case`语句（即有`case`无`break`），必须使用注释标明原因
```c
switch(val)
{
    //这种情况必须注释
    case 0:
        //code;
    case 1:
        //code;
    break;
}
```

(4) **自定义函数**必须在函数头注释中标明函数作用，最好也标明作者
```c
//系统初始化
//@author:张三
void System_Init()
{
	//code
}
```

(5) 注释应加在所描述代码的**上方或右边**，且与所描述的代码间不应有空行
```c
//不允许（隔了空行）
//允许
code;//允许
//不允许
```

(6) 代码的有效注释量应尽量在20%以上【非强制性】，但也不宜过多，不能喧宾夺主

(7) 保证代码和注释的一致性，修改代码时注意注释是否也要修改

---

## 文件分配原则

> 以下关于文件的要求希望各队员尽可能满足

(1) 仔细划分好各个模块，为每一个模块分配一组.c/.h文件，各模块间尽可能减少联系

(2) .h文件中进行**类型定义**和**变量函数的声明**，.c文件中进行**变量定义**和**函数实现**

(3) 模块对外开放的变量和函数需要在.h文件中声明以供其他模块调用，而不需要对外开放的变量和函数不应在.h文件中声明

以下为一个示例

```c
/**********Module.c**********/

#include "Module.h"

int privateVal;//模块私有全局变量，无需被外部调用
int publicVal;//模块公有全局变量，需要被外部调用

void Module_InitSubModule(void);//声明内部函数，无需被外部调用

//进行函数的实现
void Module_Init()
{
    //code
}

void Module_InitSubModule()
{
    //code
}

/**********Module.h**********/

//进行结构体等类型的定义
typedef struct{
    //code
}ModuleHandle;

extern int publicVal;//使用extern将.c文件中定义的变量声明给外部调用

void Module_Init(void);//声明外部函数

```

---

*规范版本：V2.0*

*制定时间：2021-1-27*
